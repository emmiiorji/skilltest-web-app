const startScript=()=>{const e=Date.now();let t=e,n="",a=[],r=[],o=[],i=[],s=[],c=null,d=null,u={},l="desktop";const m=window.trackingConfig||{},p=!m.disableFocusLostEvents,v=!m.disableClipboardEvents,g=!m.disablePreSubmitDelay,w=!m.disableAnswerChangeEvents,y=!m.disableDeviceFingerprint,h=!m.disableTimeToFirstInteraction,b=!m.disableMouseClickEvents,f=!m.disableKeyboardPressEvents;fetch("https://api.ipify.org").then((e=>e.text())).then((e=>{n=e}));if(l=(()=>{const e=navigator.userAgent.toLowerCase(),t=/mobile|android|iphone|ipad|phone/i.test(e);return/tablet|ipad/i.test(e)?"tablet":t?"mobile":"desktop"})(),p){let e=null;document.addEventListener("visibilitychange",(()=>{document.hidden?e=Date.now():e&&(a.push({timestamp:e,duration_ms:Date.now()-e}),e=null)})),window.addEventListener("blur",(()=>{e||(e=Date.now())})),window.addEventListener("focus",(()=>{e&&(a.push({timestamp:e,duration_ms:Date.now()-e}),e=null)}))}if(v&&(document.addEventListener("copy",(e=>{const t=window.getSelection().toString();r.push({timestamp:Date.now(),type:"copy",content:t.substring(0,100)})})),document.addEventListener("paste",(e=>{const t=e.clipboardData?.getData("text/plain")||"";r.push({timestamp:Date.now(),type:"paste",content:t.substring(0,100)})})),document.addEventListener("cut",(e=>{const t=window.getSelection().toString();r.push({timestamp:Date.now(),type:"cut",content:t.substring(0,100)})}))),w){const e=(e,t,n)=>{const a=document.querySelector('input[name="question_id"]').value;o.push({question_id:parseInt(a),previous_answer:t,new_answer:n,timestamp:Date.now(),input_type:e.type||"text"}),d=Date.now()};document.addEventListener("input",(t=>{if("answer"===t.target.name||t.target.name?.startsWith("answer-")){const n=t.target.dataset.previousValue||"";e(t.target,n,t.target.value),t.target.dataset.previousValue=t.target.value}})),document.addEventListener("change",(t=>{if("radio"===t.target.type||"checkbox"===t.target.type){const n=t.target.dataset.previousValue||"";e(t.target,n,t.target.value),t.target.dataset.previousValue=t.target.value}}))}if(b){const e=((e,t)=>{let n;return function(){const a=arguments,r=this;n||(e.apply(r,a),n=!0,setTimeout((()=>n=!1),t))}})((e=>{i.push({timestamp:Date.now(),button:0===e.button?"left":2===e.button?"right":"middle",x:e.clientX,y:e.clientY,target:e.target.tagName+(e.target.id?"#"+e.target.id:"")})}),100);document.addEventListener("click",e),document.addEventListener("contextmenu",e)}if(f){const e=((e,t)=>{let n;return function(){const a=arguments,r=this;n||(e.apply(r,a),n=!0,setTimeout((()=>n=!1),t))}})((e=>{let t="other";e.key.match(/^[a-zA-Z]$/)?t="letter":e.key.match(/^[0-9]$/)?t="number":"Backspace"===e.key?t="backspace":"Enter"===e.key?t="enter":" "===e.key?t="space":e.key.startsWith("Arrow")?t="navigation":(e.ctrlKey||e.metaKey||e.altKey)&&(t="modifier"),s.push({timestamp:Date.now(),keyType:t})}),100);document.addEventListener("keydown",e)}if(h){const t=()=>{c||(c=Date.now()-e,document.removeEventListener("click",t),document.removeEventListener("keydown",t),document.removeEventListener("input",t))};document.addEventListener("click",t),document.addEventListener("keydown",t),document.addEventListener("input",t)}if(y){const e=()=>{const e=document.createElement("canvas"),t=e.getContext("2d");t.textBaseline="top",t.font="14px Arial",t.fillText("fingerprint",2,2);const n=e.toDataURL();return{os:navigator.platform,browser:navigator.userAgent.match(/(Chrome|Firefox|Safari|Edge)\/[\d.]+/)?.[0]||"Unknown",screenResolution:`${screen.width}x${screen.height}`,colorDepth:screen.colorDepth,deviceMemory:navigator.deviceMemory||"unknown",hardwareConcurrency:navigator.hardwareConcurrency||"unknown",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,language:navigator.language,platform:navigator.platform,cookieEnabled:navigator.cookieEnabled,canvasFingerprint:n.substring(0,50)}};window.Fingerprint2?Fingerprint2.get((t=>{u={...e(),...Object.fromEntries(t.map((e=>[e.key,e.value])))}})):u=e()}let _=0,E=0,k=0,D=0;document.addEventListener("visibilitychange",(()=>{document.hidden?t=Date.now():_+=Date.now()-t})),v&&(document.addEventListener("copy",(()=>E++)),document.addEventListener("paste",(()=>k++))),b&&document.addEventListener("contextmenu",(()=>D++)),document.getElementById("answerForm").addEventListener("submit",(async t=>{t.preventDefault();const m=document.querySelector('input[name="answer_type"]')?.value;let L;if("radiobutton"===m?L=document.querySelector('input[name="answer"]:checked')?.value:"multiinput"===m?L=Array.from(document.querySelectorAll('input[name="answer"]:checked')).map((e=>e.value)):"textarea"===m?L=document.querySelector('textarea[name="answer"]').value.trim():"multiTextInput"===m&&(L=Array.from(document.querySelectorAll('input[name^="answer-"]')).map((e=>e.value.trim())).filter((e=>""!==e))),!L||Array.isArray(L)&&0===L.length)return void alert("Please provide an answer before submitting.");const S=document.querySelector('input[name="test_id"]')?.value,x=document.querySelector('input[name="question_id"]')?.value,A=document.querySelector('input[name="user_id"]')?.value,C=Date.now()-e,q=g&&d?(Date.now()-d)/1e3:0,T=(e,t=1e3)=>e.slice(0,t),F={test_id:S,question_id:x,profile_id:A,answer:L,time_taken:Math.round(C/1e3),ip:n,copy_count:E,paste_count:k,right_click_count:D,inactive_time:Math.round(_/1e3),focus_lost_events:p?T(a):[],clipboard_events:v?T(r):[],pre_submit_delay:g?q:0,answer_change_events:w?T(o):[],device_fingerprint:y?u:{},device_type:l,time_to_first_interaction:h&&c?c/1e3:0,mouse_click_events:b?T(i):[],keyboard_press_events:f?T(s):[]},I=document.querySelector('input[name="result_salt"]')?.value,M=((e,t)=>{const n=JSON.stringify(e);let a="";for(let e=0;e<n.length;e++)a+=String.fromCharCode(n.charCodeAt(e)^t.charCodeAt(e%t.length));return btoa(a)})(F,A+I);try{if(!(await fetch(t.target.action,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",trc:navigator.userAgent},body:"hashed_payload="+encodeURIComponent(M)})).ok)throw new Error("Server responded with an error");window.location.reload()}catch(e){console.error("Error:",e),alert("An error occurred. Please try again.")}}))};startScript();