const startScript=()=>{const e=Date.now();let t=0,n=e,r=0,o=0,a=0,i="";fetch("https://api.ipify.org").then((e=>e.text())).then((e=>{i=e})),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("question-div").children;for(let t of e)t.style.maxWidth="100%",t.style.maxHeight="100%"})),document.addEventListener("visibilitychange",(()=>{document.hidden?n=Date.now():t+=Date.now()-n})),document.addEventListener("copy",(()=>r++)),document.addEventListener("paste",(()=>o++)),document.addEventListener("contextmenu",(e=>{a++}));const u=()=>{const e=document.getElementById("submitButton");e.disabled=!1,e.style.opacity="1",e.style.cursor="pointer",e.textContent="Submit Answer"};document.getElementById("answerForm").addEventListener("submit",(async n=>{n.preventDefault(),(()=>{const e=document.getElementById("submitButton");e.disabled=!0,e.style.opacity="0.5",e.style.cursor="not-allowed",e.textContent="Submitting..."})();const c=document.querySelector('input[name="answer_type"]')?.value;let d;if("radiobutton"===c?d=document.querySelector('input[name="answer"]:checked')?.value:"multiinput"===c?d=Array.from(document.querySelectorAll('input[name="answer"]:checked')).map((e=>e.value)):"textarea"===c?d=document.querySelector('textarea[name="answer"]').value.trim():"multiTextInput"===c&&(d=Array.from(document.querySelectorAll('input[name^="answer-"]')).map((e=>e.value.trim())).filter((e=>""!==e))),!d||Array.isArray(d)&&0===d.length)return alert("Please provide an answer before submitting."),void u();const s=document.querySelector('input[name="test_id"]')?.value,l=document.querySelector('input[name="question_id"]')?.value,m=document.querySelector('input[name="user_id"]')?.value,y=Date.now()-e,p={test_id:s,question_id:l,profile_id:m,answer:d,time_taken:Math.round(y/1e3),ip:i,copy_count:r?1:0,paste_count:o?1:0,right_click_count:a?1:0,inactive_time:Math.round(t/1e3)},h=document.querySelector('input[name="result_salt"]')?.value,w=((e,t)=>{const n=JSON.stringify(e);let r="";for(let e=0;e<n.length;e++)r+=String.fromCharCode(n.charCodeAt(e)^t.charCodeAt(e%t.length));return btoa(r)})(p,m+h);try{if(!(await(async(e,t)=>{const n={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",trc:navigator.userAgent},body:t};return e.startsWith("https://localhost")&&(n.agent=new https.Agent({rejectUnauthorized:!1})),fetch(e,n)})(n.target.action,"hashed_payload="+encodeURIComponent(w))).ok)throw new Error("Server responded with an error");window.location.reload()}catch(e){console.error("Error:",e),alert("An error occurred. Please try again."),u()}}))};startScript();